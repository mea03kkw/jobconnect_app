{% extends "base.html" %}
{% block title %}Apply for Job{% endblock %}
{% block content %}
<div class="container">
    <h2 class="mb-4">Apply for Job</h2>
    <div class="card">
        <div class="card-body">
            <h5 class="card-title">{{ job.title }}</h5>
            <h6 class="card-subtitle mb-2 text-muted">{{ job.company }} - {{ job.location }}</h6>
            <p class="card-text">{{ job.description }}</p>
        </div>
    </div>
    {% if existing_application %}
        <div class="alert alert-info mt-4">
            <h5>You have already applied for this job.</h5>
            <p>Application Date: {{ existing_application.date_applied.strftime('%Y-%m-%d %H:%M:%S') }}</p>
            <p>Resume Text: {{ existing_application.resume_text or 'No resume provided' }}</p>
        </div>
        <a href="{{ url_for('withdraw_application', job_id=job.id) }}" class="btn btn-danger">Withdraw Application</a>
        <a href="{{ url_for('job_seeker_dashboard') }}" class="btn btn-secondary">Back to Dashboard</a>
    {% else %}
        <form method="POST" class="mt-4">
            <div class="mb-3">
                <label for="resume_text" class="form-label">Resume/Cover Letter</label>
                <textarea class="form-control" id="resume_text" name="resume_text" rows="10" placeholder="Enter your resume or cover letter here..."></textarea>
            </div>
            <button type="submit" class="btn btn-success">Submit Application</button>
            <a href="{{ url_for('job_seeker_dashboard') }}" class="btn btn-secondary">Cancel</a>
        </form>
    {% endif %}
</div>
{% endblock %}